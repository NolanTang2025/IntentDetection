<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·æ„å›¾åˆ†æå¹³å° | Intent Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <!-- WordCloudåº“ - ä½¿ç”¨å¤šä¸ªCDNå¤‡ç”¨ -->
    <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.2.2/src/wordcloud2.js" 
            onerror="loadWordCloudFallback()"></script>
    <script>
        // WordCloudåº“åŠ è½½å¤±è´¥æ—¶çš„å¤‡ç”¨æ–¹æ¡ˆ
        function loadWordCloudFallback() {
            console.warn('ä¸»CDNåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN...');
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/wordcloud@1.2.2/src/wordcloud2.js';
            script.onerror = function() {
                console.error('æ‰€æœ‰WordCloud CDNéƒ½åŠ è½½å¤±è´¥');
                window.WordCloudLoaded = false;
            };
            script.onload = function() {
                console.log('WordCloudåº“ä»å¤‡ç”¨CDNåŠ è½½æˆåŠŸ');
                window.WordCloudLoaded = true;
                // å¦‚æœé¡µé¢å·²ç»åŠ è½½ï¼Œé‡æ–°æ¸²æŸ“è¯äº‘
                if (typeof renderAllWordClouds === 'function') {
                    setTimeout(renderAllWordClouds, 100);
                }
            };
            document.head.appendChild(script);
        }
        
        // æ£€æŸ¥WordCloudæ˜¯å¦åŠ è½½æˆåŠŸ
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (typeof WordCloud !== 'undefined' || typeof window.WordCloud !== 'undefined') {
                    window.WordCloudLoaded = true;
                    console.log('WordCloudåº“å·²åŠ è½½');
                } else {
                    console.error('WordCloudåº“æœªåŠ è½½');
                    window.WordCloudLoaded = false;
                }
            }, 500);
        });
    </script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="../../index.html" class="back-button" data-i18n-title="header.backTitle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span data-i18n="back">è¿”å›ä¸»é¡µ</span>
                </a>
                <div class="brand-logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="brand-text">
                    <span class="brand-name">Intent Analytics</span>
                    <span class="brand-subtitle" data-i18n="brand.subtitle">ç”¨æˆ·æ„å›¾åˆ†æå¹³å°</span>
                </div>
            </div>
            
            <div class="navbar-menu">
                <a href="#" class="nav-link active" data-tab="home" data-i18n="nav.home">é¦–é¡µ</a>
                <a href="#" class="nav-link" data-tab="overview" data-i18n="nav.overview">æ€»è§ˆ</a>
                <a href="#" class="nav-link" data-tab="journey" data-i18n="nav.journey">è½¬åŒ–åˆ†æ</a>
                <a href="#" class="nav-link" data-tab="clusters" data-i18n="nav.clusters">ç”¨æˆ·åˆ†æ</a>
            </div>
            
            <!-- åº—é“ºé€‰æ‹©å™¨ -->
            <div class="shop-selector-nav" id="shopSelectorContainer">
                <select id="shopSelector" class="shop-select-dropdown">
                    <option value="">é€‰æ‹©åº—é“º...</option>
                    <option value="28">åº—é“º 28</option>
                    <option value="29">åº—é“º 29</option>
                    <option value="39">åº—é“º 39</option>
                    <option value="49">åº—é“º 49</option>
                    <option value="53">åº—é“º 53</option>
                </select>
            </div>
            
            <!-- è¯­è¨€åˆ‡æ¢å™¨ -->
            <div class="language-switcher">
                <button class="lang-btn" id="langBtn" title="Switch Language">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                    </svg>
                    <span id="currentLang">ä¸­æ–‡</span>
                </button>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <!-- ä»ªè¡¨æ¿å¤´éƒ¨ï¼ˆä»…åœ¨éé¦–é¡µæ˜¾ç¤ºï¼‰ -->
        <header class="dashboard-header" id="dashboardHeader" style="display: none;">
            <div class="header-content">
                <div>
                    <h1 data-i18n="header.overview">æ•°æ®æ€»è§ˆ</h1>
                    <p class="subtitle" data-i18n="header.overviewSubtitle">å®æ—¶ç”¨æˆ·æ„å›¾åˆ†æä¸ä¸šåŠ¡æ´å¯Ÿ</p>
                </div>
                <div class="header-actions">
                    <div class="update-settings">
                        <div class="auto-update-selector">
                            <label for="autoUpdateInterval" data-i18n="header.autoUpdate">è‡ªåŠ¨æ›´æ–°ï¼š</label>
                            <select id="autoUpdateInterval" class="update-select">
                                <option value="manual" data-i18n="header.manual">æ‰‹åŠ¨æ›´æ–°</option>
                                <option value="3days" data-i18n="header.update3days">æ¯3å¤©</option>
                                <option value="1week" data-i18n="header.update1week">æ¯å‘¨</option>
                                <option value="1month" data-i18n="header.update1month">æ¯æœˆ</option>
                                <option value="3months" data-i18n="header.update3months">æ¯3ä¸ªæœˆ</option>
                            </select>
                        </div>
                        <button class="btn-update" id="updateClustersBtn" data-i18n-title="header.updateClustersTitle">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 2v4M2 6l6-4 6 4M8 14v-4M14 10l-6 4-6-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span data-i18n="header.updateClusters">æ›´æ–°èšç±»</span>
                        </button>
                    </div>
                    <button class="btn-secondary">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 2v4M2 2v4M2 2h12M2 6h12v8a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span data-i18n="header.selectDate">é€‰æ‹©æ—¥æœŸ</span>
                    </button>
                    <button class="btn-primary">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span data-i18n="header.exportReport">å¯¼å‡ºæŠ¥å‘Š</span>
                    </button>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalUsers">276</div>
                        <div class="stat-label" data-i18n="header.stats.totalUsers">ç‹¬ç«‹ç”¨æˆ·</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96" stroke="currentColor" stroke-width="2"/>
                            <line x1="12" y1="22.08" x2="12" y2="12" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalSegments">344</div>
                        <div class="stat-label" data-i18n="header.stats.totalSegments">æ„å›¾ç‰‡æ®µ</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 17l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalClusters">15</div>
                        <div class="stat-label" data-i18n="header.stats.totalClusters">ç”¨æˆ·èšç±»</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="dashboard-main">
            <!-- é¦–é¡µæ ‡ç­¾é¡µ -->
            <div id="home" class="tab-content active">
                <div class="homepage-hero">
                    <div class="hero-content">
                        <h1 data-i18n="home.title">ç”¨æˆ·æ„å›¾èšç±»åˆ†æå¹³å°</h1>
                        <p class="hero-subtitle" data-i18n="home.subtitle">åŸºäºä¸šåŠ¡ç»´åº¦çš„æ™ºèƒ½ç”¨æˆ·ç»†åˆ†ï¼Œé©±åŠ¨ç²¾å‡†è¥é”€ç­–ç•¥</p>
                        <div class="hero-stats">
                            <div class="hero-stat">
                                <div class="hero-stat-value" id="homeTotalUsers">276</div>
                                <div class="hero-stat-label" data-i18n="home.stats.users">ç‹¬ç«‹ç”¨æˆ·</div>
                            </div>
                            <div class="hero-stat">
                                <div class="hero-stat-value" id="homeTotalClusters">15</div>
                                <div class="hero-stat-label" data-i18n="home.stats.clusters">ç”¨æˆ·èšç±»</div>
                            </div>
                            <div class="hero-stat">
                                <div class="hero-stat-value" id="homeTotalSegments">344</div>
                                <div class="hero-stat-label" data-i18n="home.stats.segments">æ„å›¾ç‰‡æ®µ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="clustering-intro">
                    <div class="intro-header">
                        <h2 data-i18n="home.methodology.title">ç”¨æˆ·èšç±»æ–¹æ³•è®º</h2>
                        <p data-i18n="home.methodology.description">åŸºäºä¸šåŠ¡ç»´åº¦çš„æ™ºèƒ½èšç±»ï¼Œç¡®ä¿æ¯ä¸ªèšç±»éƒ½æœ‰æ˜ç¡®çš„ä¸šåŠ¡å«ä¹‰å’Œå·®å¼‚åŒ–çš„è¥é”€ç­–ç•¥</p>
                    </div>

                    <div class="clustering-dimensions">
                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 11l3 3L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.purchaseStage.title">è´­ä¹°é˜¶æ®µ</h3>
                            <p data-i18n="home.dimensions.purchaseStage.desc">è¯†åˆ«ç”¨æˆ·å¤„äºè´­ä¹°æ¼æ–—çš„å“ªä¸ªé˜¶æ®µ</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.purchaseStage.tags.0">æµè§ˆé˜¶æ®µ</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.purchaseStage.tags.1">å¯¹æ¯”é˜¶æ®µ</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.purchaseStage.tags.2">å†³ç­–é˜¶æ®µ</span>
                            </div>
                        </div>

                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <line x1="12" y1="1" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.priceSensitivity.title">ä»·æ ¼æ•æ„Ÿåº¦</h3>
                            <p data-i18n="home.dimensions.priceSensitivity.desc">åˆ†æç”¨æˆ·å¯¹ä»·æ ¼çš„æ•æ„Ÿç¨‹åº¦</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.priceSensitivity.tags.0">ä»·æ ¼æ•æ„Ÿå‹</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.priceSensitivity.tags.1">ä¸­ç­‰ä»·æ ¼å‹</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.priceSensitivity.tags.2">é«˜ç«¯ä»·å€¼å‹</span>
                            </div>
                        </div>

                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.engagement.title">å‚ä¸åº¦</h3>
                            <p data-i18n="home.dimensions.engagement.desc">è¯„ä¼°ç”¨æˆ·çš„æµè§ˆæ·±åº¦å’Œå‚ä¸ç¨‹åº¦</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.engagement.tags.0">å¿«é€Ÿæµè§ˆè€…</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.engagement.tags.1">ä¸­ç­‰å‚ä¸</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.engagement.tags.2">æ·±åº¦ç ”ç©¶è€…</span>
                            </div>
                        </div>

                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20 7h-4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.productPreference.title">äº§å“åå¥½</h3>
                            <p data-i18n="home.dimensions.productPreference.desc">è¯†åˆ«ç”¨æˆ·å…³æ³¨çš„äº§å“ç±»å‹å’Œå‹å·</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.productPreference.tags.0">Z6åå¥½</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.productPreference.tags.1">A1åå¥½</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.productPreference.tags.2">F1åå¥½</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.productPreference.tags.3">å¤šäº§å“æ¯”è¾ƒ</span>
                            </div>
                        </div>

                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 17l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.concerns.title">å…³æ³¨ç‚¹</h3>
                            <p data-i18n="home.dimensions.concerns.desc">äº†è§£ç”¨æˆ·æœ€å…³å¿ƒçš„äº§å“ç‰¹æ€§</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.concerns.tags.0">åŠŸèƒ½å¯¼å‘</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.concerns.tags.1">ä»·æ ¼å¯¼å‘</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.concerns.tags.2">èˆ’é€‚åº¦å¯¼å‘</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.concerns.tags.3">æœ‰æ•ˆæ€§å¯¼å‘</span>
                            </div>
                        </div>

                        <div class="dimension-card">
                            <div class="dimension-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.dimensions.coreNeeds.title">æ ¸å¿ƒéœ€æ±‚</h3>
                            <p data-i18n="home.dimensions.coreNeeds.desc">è¯†åˆ«ç”¨æˆ·çš„æ ¸å¿ƒè´­ä¹°åŠ¨æœº</p>
                            <div class="dimension-tags">
                                <span class="dimension-tag" data-i18n="home.dimensions.coreNeeds.tags.0">æ­¢é¼¾éœ€æ±‚</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.coreNeeds.tags.1">é¢ˆéƒ¨ç–¼ç—›</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.coreNeeds.tags.2">ç¡çœ è´¨é‡</span>
                                <span class="dimension-tag" data-i18n="home.dimensions.coreNeeds.tags.3">ç»¼åˆéœ€æ±‚</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="clustering-benefits">
                    <div class="benefits-header">
                        <h2 data-i18n="home.benefits.title">èšç±»ä»·å€¼</h2>
                        <p data-i18n="home.benefits.description">æ¯ä¸ªèšç±»éƒ½æœ‰æ˜ç¡®çš„ä¸šåŠ¡å«ä¹‰å’Œå·®å¼‚åŒ–çš„è¥é”€ç­–ç•¥</p>
                    </div>

                    <div class="benefits-grid">
                        <div class="benefit-card">
                            <div class="benefit-number" data-i18n="home.benefits.items.clear.number">01</div>
                            <h3 data-i18n="home.benefits.items.clear.title">æ˜ç¡®çš„ä¸šåŠ¡åŒºåˆ†</h3>
                            <p data-i18n="home.benefits.items.clear.desc">åŸºäºä¸šåŠ¡ç»´åº¦èšç±»ï¼Œæ¯ä¸ªèšç±»éƒ½æœ‰æ¸…æ™°çš„æ ‡ç­¾å’Œç‰¹å¾ï¼Œæ˜“äºç†è§£å’Œåº”ç”¨</p>
                        </div>
                        <div class="benefit-card">
                            <div class="benefit-number" data-i18n="home.benefits.items.strategy.number">02</div>
                            <h3 data-i18n="home.benefits.items.strategy.title">å·®å¼‚åŒ–è¥é”€ç­–ç•¥</h3>
                            <p data-i18n="home.benefits.items.strategy.desc">é’ˆå¯¹ä¸åŒèšç±»æä¾›ç‹¬ç‰¹çš„è¥é”€å»ºè®®ï¼Œç¡®ä¿æ¯ä¸ªç¾¤ä½“éƒ½æœ‰é’ˆå¯¹æ€§çš„ç­–ç•¥</p>
                        </div>
                        <div class="benefit-card">
                            <div class="benefit-number" data-i18n="home.benefits.items.actionable.number">03</div>
                            <h3 data-i18n="home.benefits.items.actionable.title">å¯æ‰§è¡Œçš„è¡ŒåŠ¨å»ºè®®</h3>
                            <p data-i18n="home.benefits.items.actionable.desc">æä¾›å…·ä½“çš„è¥é”€æ´»åŠ¨ã€å†…å®¹ç­–ç•¥å’Œè½¬åŒ–ä¼˜åŒ–å»ºè®®ï¼Œå¯ç›´æ¥åº”ç”¨åˆ°ä¸šåŠ¡ä¸­</p>
                        </div>
                        <div class="benefit-card">
                            <div class="benefit-number" data-i18n="home.benefits.items.dataDriven.number">04</div>
                            <h3 data-i18n="home.benefits.items.dataDriven.title">æ•°æ®é©±åŠ¨å†³ç­–</h3>
                            <p data-i18n="home.benefits.items.dataDriven.desc">åŸºäºçœŸå®çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œç¡®ä¿è¥é”€ç­–ç•¥çš„ç§‘å­¦æ€§å’Œæœ‰æ•ˆæ€§</p>
                        </div>
                    </div>
                </div>

                <div class="quick-actions">
                    <h2 data-i18n="home.quickActions.title">å¿«é€Ÿå¼€å§‹</h2>
                    <div class="actions-grid">
                        <a href="#" class="action-card" data-tab="overview">
                            <div class="action-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <line x1="18" y1="20" x2="18" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="12" y1="20" x2="12" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="6" y1="20" x2="6" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.quickActions.overview.title">æŸ¥çœ‹æ•°æ®æ€»è§ˆ</h3>
                            <p data-i18n="home.quickActions.overview.desc">äº†è§£æ•´ä½“ç”¨æˆ·æ„å›¾åˆ†å¸ƒå’Œå…³é”®æŒ‡æ ‡</p>
                        </a>
                        <a href="#" class="action-card" data-tab="clusters">
                            <div class="action-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h3 data-i18n="home.quickActions.clusters.title">åˆ†æç”¨æˆ·èšç±»</h3>
                            <p data-i18n="home.quickActions.clusters.desc">æ·±å…¥äº†è§£æ¯ä¸ªç”¨æˆ·ç¾¤ä½“çš„ç‰¹å¾</p>
                        </a>
                        <a href="#" class="action-card business-insights-card" data-tab="financial" style="position: relative;">
                            <div class="action-icon" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 17l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <h3 data-i18n="home.quickActions.businessInsights.title">ä¸šåŠ¡æ´å¯Ÿåˆ†æ</h3>
                                <span class="beta-badge" style="font-size: 0.65rem; padding: 0.15rem 0.4rem;">BETA</span>
                            </div>
                            <p data-i18n="home.quickActions.businessInsights.desc">åŸºäºé‡‘èç‰¹å¾çš„æ™ºèƒ½ç”¨æˆ·ç»†åˆ†ä¸è¿è¥ç­–ç•¥</p>
                        </a>
                    </div>
                </div>
            </div>

            <!-- æ€»è§ˆæ ‡ç­¾é¡µ -->
            <div id="overview" class="tab-content">
                <div class="section-title">
                    <h2 data-i18n="overview.title">æ•°æ®æ€»è§ˆ</h2>
                    <p data-i18n="overview.subtitle">æ•´ä½“ç”¨æˆ·æ„å›¾åˆ†ææ¦‚è§ˆä¸å…³é”®æŒ‡æ ‡</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 data-i18n="overview.charts.clusterDistribution">ç”¨æˆ·èšç±»åˆ†å¸ƒ</h3>
                        <canvas id="clusterDistributionChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3 data-i18n="overview.charts.purchaseStage">è´­ä¹°é˜¶æ®µåˆ†å¸ƒ</h3>
                        <canvas id="purchaseStageChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3 data-i18n="overview.charts.pricePreference">ä»·æ ¼åå¥½åˆ†å¸ƒ</h3>
                        <canvas id="pricePreferenceChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3 data-i18n="overview.charts.concerns">æ ¸å¿ƒå…³æ³¨ç‚¹</h3>
                        <canvas id="concernsChart"></canvas>
                    </div>
                </div>

                <div class="insights-summary">
                    <div class="section-header">
                        <h3 data-i18n="overview.insights.title">å…³é”®æ´å¯Ÿ</h3>
                        <span class="section-badge" data-i18n="overview.insights.badge">å®æ—¶æ›´æ–°</span>
                    </div>
                    <div class="insights-grid" id="keyInsights">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- è½¬åŒ–åˆ†ææ ‡ç­¾é¡µ -->
            <div id="journey" class="tab-content">
                <div class="section-title">
                    <h2 data-i18n="journey.title">è½¬åŒ–åˆ†æ</h2>
                    <p data-i18n="journey.subtitle">æ¢ç´¢ç”¨æˆ·è½¬åŒ–è·¯å¾„ä¸æ„å›¾è½¨è¿¹</p>
                </div>

                <!-- å­æ ‡ç­¾é¡µåˆ‡æ¢ -->
                <div class="sub-tabs">
                    <button class="sub-tab-btn active" data-sub-tab="path" onclick="switchSubTab('path')">
                        <span data-i18n="journey.tabs.path">è½¬åŒ–è·¯å¾„</span>
                    </button>
                    <button class="sub-tab-btn" data-sub-tab="trajectory" onclick="switchSubTab('trajectory')">
                        <span data-i18n="journey.tabs.trajectory">ç”¨æˆ·è½¨è¿¹</span>
                    </button>
                    <button class="sub-tab-btn" data-sub-tab="cluster" onclick="switchSubTab('cluster')">
                        <span data-i18n="journey.tabs.cluster">ç”¨æˆ·èšç±»</span>
                    </button>
                </div>

                <!-- è½¬åŒ–è·¯å¾„å­é¡µé¢ -->
                <div id="subTab-path" class="sub-tab-content active">
                    <div class="journey-hero">
                        <h1 data-i18n="journey.path.title">ç”¨æˆ·è½¬åŒ–è·¯å¾„å¯è§†åŒ–</h1>
                        <p data-i18n="journey.path.subtitle">æ¢ç´¢ç”¨æˆ·ä»æµè§ˆåˆ°å†³ç­–çš„å®Œæ•´æ—…ç¨‹ï¼Œäº†è§£ä¸åŒç”»åƒåœ¨è½¬åŒ–å„é˜¶æ®µçš„åˆ†å¸ƒ</p>
                    </div>
                    <div id="journeyVisualization" class="journey-container">
                        <!-- åŠ¨æ€ç”Ÿæˆè½¬åŒ–è·¯å¾„ -->
                    </div>
                </div>

                <!-- ç”¨æˆ·è½¨è¿¹å­é¡µé¢ -->
                <div id="subTab-trajectory" class="sub-tab-content">
                    <div class="section-title" style="margin-top: 0;">
                        <h3 data-i18n="journey.trajectory.title">ç”¨æˆ·æ„å›¾è½¨è¿¹åˆ†æ</h3>
                        <p data-i18n="journey.trajectory.subtitle">æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·åœ¨ä¸åŒæ—¶é—´æ®µçš„æ„å›¾åˆ‡ç‰‡åŠå…¶å¯¹åº”çš„èšç±»åˆ†å¸ƒ</p>
                    </div>

                    <!-- æœç´¢å’Œç­›é€‰ -->
                    <div class="user-filters" style="margin-bottom: 2rem; display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                        <div class="search-box" style="flex: 1; min-width: 300px;">
                            <input type="text" id="userSearch" data-i18n-placeholder="journey.trajectory.search" placeholder="æœç´¢ç”¨æˆ·ID..." style="width: 100%; padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                        </div>
                        <div class="filter-group">
                            <label style="margin-right: 0.5rem; color: var(--text-secondary);" data-i18n="journey.trajectory.filter">ç­›é€‰:</label>
                            <select id="clusterFilter" style="padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                                <option value="" data-i18n="journey.trajectory.allClusters">æ‰€æœ‰èšç±»</option>
                            </select>
                        </div>
                        <div class="sort-group">
                            <label style="margin-right: 0.5rem; color: var(--text-secondary);" data-i18n="journey.trajectory.sort">æ’åº:</label>
                            <select id="sortOption" style="padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                                <option value="time" data-i18n="journey.trajectory.sortByTime">æŒ‰æ—¶é—´</option>
                                <option value="segments" data-i18n="journey.trajectory.sortBySegments">æŒ‰ç‰‡æ®µæ•°</option>
                                <option value="clusters" data-i18n="journey.trajectory.sortByClusters">æŒ‰èšç±»æ•°</option>
                            </select>
                        </div>
                    </div>

                    <!-- ç”¨æˆ·åˆ—è¡¨ -->
                    <div id="userTrajectories" class="user-trajectories">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- ç”¨æˆ·èšç±»å­é¡µé¢ -->
                <div id="subTab-cluster" class="sub-tab-content">
                    <div class="section-title" style="margin-top: 0;">
                        <h3 data-i18n="journey.cluster.title">ç”¨æˆ·èšç±»åˆ†æ</h3>
                        <p data-i18n="journey.cluster.subtitle">æ·±å…¥äº†è§£æ¯ä¸ªç”¨æˆ·ç¾¤ä½“çš„ç‰¹å¾ä¸è¡Œä¸ºæ¨¡å¼</p>
                    </div>

                    <div class="cluster-selector">
                        <label for="clusterSelect" data-i18n="journey.cluster.select">é€‰æ‹©èšç±»ï¼š</label>
                        <select id="clusterSelect" onchange="showClusterDetails(this.value)">
                            <option value="" data-i18n="journey.cluster.selectPlaceholder">-- é€‰æ‹©èšç±» --</option>
                        </select>
                    </div>

                    <div id="clusterDetails" class="cluster-details">
                        <!-- åŠ¨æ€ç”Ÿæˆèšç±»è¯¦æƒ… -->
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·åˆ†ææ ‡ç­¾é¡µ -->
            <div id="clusters" class="tab-content">
                <div class="section-title">
                    <h2 data-i18n="clusters.title">ç”¨æˆ·åˆ†æ</h2>
                    <p data-i18n="clusters.subtitle">æ·±å…¥äº†è§£ç”¨æˆ·ç¾¤ä½“ç‰¹å¾ä¸è¡Œä¸ºæ¨¡å¼</p>
                </div>

                <!-- å­æ ‡ç­¾é¡µåˆ‡æ¢ -->
                <div class="sub-tabs">
                    <button class="sub-tab-btn active" data-sub-tab="portrait" onclick="switchSubTab('portrait')">
                        <span data-i18n="clusters.portrait.title">ç”¨æˆ·ç”»åƒåˆ†æ</span>
                    </button>
                </div>

                <!-- ç”¨æˆ·ç”»åƒå­é¡µé¢ -->
                <div id="subTab-portrait" class="sub-tab-content active">
                    <div class="section-title" style="margin-top: 0;">
                        <h3 data-i18n="clusters.portrait.title">ç”¨æˆ·ç”»åƒåˆ†æ</h3>
                        <p data-i18n="clusters.portrait.subtitle">è¯¦ç»†çš„ç”¨æˆ·ç‰¹å¾ã€è¡Œä¸ºæ¨¡å¼ä¸åå¥½åˆ†æ</p>
                    </div>

                    <div class="portrait-cards" id="portraitCards">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- é‡‘èå¸‚åœºåˆ†ææ ‡ç­¾é¡µ (Beta) -->
            <div id="financial" class="tab-content">
                <!-- é¡¶éƒ¨ä¸šåŠ¡æ¦‚è§ˆ -->
                <div class="financial-dashboard-header" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); padding: 2rem; border-radius: 16px; margin-bottom: 2rem; border: 1px solid var(--border);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="margin: 0 0 0.5rem 0; color: var(--text); font-size: 1.75rem;">YUPç”¨æˆ·è¡Œä¸ºåˆ†æ <span class="beta-badge">BETA</span></h2>
                            <p style="margin: 0; color: var(--text-secondary);">åŸºäºç”¨æˆ·è¡Œä¸ºç‰¹å¾çš„æ™ºèƒ½ç»†åˆ†ï¼Œå¸®åŠ©æ‚¨ç²¾å‡†è¿è¥å’Œè½¬åŒ–</p>
                        </div>
                    </div>
                    
                    <!-- æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡ -->
                    <div id="financialStats" class="financial-kpi-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem;">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- å¿«é€Ÿæ´å¯Ÿå¡ç‰‡ -->
                <div id="financialQuickInsights" style="margin-bottom: 2rem;">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- å­æ ‡ç­¾é¡µåˆ‡æ¢ -->
                <div class="sub-tabs">
                    <button class="sub-tab-btn active" data-sub-tab="financial-overview" onclick="switchFinancialSubTab('overview')">
                        <span>ğŸ“Š ç”¨æˆ·åˆ†ç»„</span>
                    </button>
                    <button class="sub-tab-btn" data-sub-tab="financial-portrait" onclick="switchFinancialSubTab('portrait')">
                        <span>ğŸ”„ ç”¨æˆ·è½¨è¿¹</span>
                    </button>
                    <button class="sub-tab-btn" data-sub-tab="financial-clusters" onclick="switchFinancialSubTab('clusters')">
                        <span>ğŸ¯ è¿è¥ç­–ç•¥</span>
                    </button>
                </div>

                <!-- èšç±»æ€»è§ˆå­é¡µé¢ -->
                <div id="subTab-financial-overview" class="sub-tab-content active">
                    <!-- ç”¨æˆ·åˆ†ç»„å¡ç‰‡ -->
                    <div id="financialUserGroups" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>

                    <!-- æ•°æ®åˆ†å¸ƒå›¾è¡¨ -->
                    <div class="section-title" style="margin-top: 2rem; margin-bottom: 1.5rem;">
                        <h3>æ•°æ®åˆ†å¸ƒ</h3>
                        <p>ç”¨æˆ·çŠ¶æ€å’Œè¡Œä¸ºåˆ†å¸ƒæ¦‚è§ˆ</p>
                    </div>

                    <div class="charts-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                        <div class="chart-card">
                            <h3>ç”¨æˆ·çŠ¶æ€åˆ†å¸ƒ</h3>
                            <canvas id="financialTransactionStatusChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>èº«ä»½éªŒè¯è¿›åº¦</h3>
                            <canvas id="financialKYCStatusChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>ç”¨æˆ·è¡Œä¸ºåå¥½</h3>
                            <canvas id="financialMainActivityChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- ç”¨æˆ·è½¨è¿¹å­é¡µé¢ -->
                <div id="subTab-financial-portrait" class="sub-tab-content">
                    <div class="section-title" style="margin-top: 0;">
                        <h3>ç”¨æˆ·æ„å›¾è½¨è¿¹åˆ†æ</h3>
                        <p>æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·åœ¨ä¸åŒæ—¶é—´æ®µçš„æ„å›¾åˆ‡ç‰‡åŠå…¶å¯¹åº”çš„èšç±»åˆ†å¸ƒ</p>
                    </div>

                    <!-- æœç´¢å’Œç­›é€‰ -->
                    <div class="user-filters" style="margin-bottom: 2rem; display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                        <div class="search-box" style="flex: 1; min-width: 300px;">
                            <input type="text" id="financialUserSearch" placeholder="æœç´¢ç”¨æˆ·ID..." style="width: 100%; padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                        </div>
                        <div class="filter-group">
                            <label style="margin-right: 0.5rem; color: var(--text-secondary);">ç­›é€‰:</label>
                            <select id="financialClusterFilter" style="padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                                <option value="">æ‰€æœ‰èšç±»</option>
                            </select>
                        </div>
                        <div class="sort-group">
                            <label style="margin-right: 0.5rem; color: var(--text-secondary);">æ’åº:</label>
                            <select id="financialSortOption" style="padding: 0.75rem 1rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                                <option value="time">æŒ‰æ—¶é—´</option>
                                <option value="segments">æŒ‰ç‰‡æ®µæ•°</option>
                                <option value="clusters">æŒ‰èšç±»æ•°</option>
                            </select>
                        </div>
                    </div>

                    <!-- ç”¨æˆ·åˆ—è¡¨ -->
                    <div id="financialUserTrajectories" class="user-trajectories">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- è¿è¥ç­–ç•¥å­é¡µé¢ -->
                <div id="subTab-financial-clusters" class="sub-tab-content">
                    <div class="section-title" style="margin-top: 0;">
                        <h3>ç²¾å‡†è¿è¥ç­–ç•¥</h3>
                        <p>é’ˆå¯¹ä¸åŒç”¨æˆ·ç¾¤ä½“çš„ä¸ªæ€§åŒ–è¿è¥å»ºè®®å’Œè¡ŒåŠ¨æ–¹æ¡ˆ</p>
                    </div>

                    <div class="cluster-selector" style="margin-bottom: 2rem;">
                        <label for="financialClusterSelect" style="font-weight: 600; color: var(--text); margin-right: 1rem;">é€‰æ‹©ç”¨æˆ·ç¾¤ä½“ï¼š</label>
                        <select id="financialClusterSelect" onchange="showFinancialClusterDetails(this.value)" style="padding: 0.75rem 1.5rem; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 1rem; min-width: 300px;">
                            <option value="">-- è¯·é€‰æ‹©ç”¨æˆ·ç¾¤ä½“ --</option>
                        </select>
                    </div>

                    <div id="financialClusterDetails" class="cluster-details">
                        <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ‘†</div>
                            <p style="font-size: 1.1rem;">è¯·åœ¨ä¸Šæ–¹é€‰æ‹©ç”¨æˆ·ç¾¤ä½“ï¼ŒæŸ¥çœ‹è¯¦ç»†çš„è¿è¥ç­–ç•¥</p>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- é¡µè„š -->
        <footer class="dashboard-footer">
            <div class="footer-content">
                <div class="footer-left">
                    <p>Â© 2025 Intent Analytics Platform. All rights reserved.</p>
                </div>
                <div class="footer-right">
                    <a href="#" data-i18n="footer.help">å¸®åŠ©æ–‡æ¡£</a>
                    <a href="#" data-i18n="footer.api">APIæ–‡æ¡£</a>
                    <a href="#" data-i18n="footer.contact">è”ç³»æˆ‘ä»¬</a>
                </div>
            </div>
        </footer>
    </div>

    <script src="i18n.js"></script>
    <!-- ä¼˜å…ˆåŠ è½½å¤šåº—é“ºæ•°æ®ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åŠ è½½é»˜è®¤æ•°æ® -->
    <script src="multi_shop_data.js" onerror="loadDefaultData()"></script>
    <script>
        function loadDefaultData() {
            const script = document.createElement('script');
            script.src = 'data.js';
            document.head.appendChild(script);
        }
    </script>
    <script src="dashboard.js"></script>
    <script>
        // åº—é“ºåˆ‡æ¢åŠŸèƒ½
        let currentShopId = null;
        
        // åˆå§‹åŒ–åº—é“ºé€‰æ‹©å™¨
        function initShopSelector() {
            const shopSelector = document.getElementById('shopSelector');
            if (!shopSelector) return;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å¤šåº—é“ºæ•°æ®
            if (typeof shopSummary === 'undefined' || typeof shopData === 'undefined') {
                // å¦‚æœæ²¡æœ‰å¤šåº—é“ºæ•°æ®ï¼Œéšè—é€‰æ‹©å™¨å¹¶ä½¿ç”¨é»˜è®¤æ•°æ®
                shopSelector.style.display = 'none';
                console.log('ä½¿ç”¨é»˜è®¤æ•°æ®æ–‡ä»¶');
                return;
            }
            
            // å¡«å……åº—é“ºé€‰é¡¹ï¼ˆæ’é™¤YUPï¼ŒYUPåªåœ¨é‡‘èåˆ†ætabä¸­æ˜¾ç¤ºï¼‰
            shopSelector.innerHTML = '<option value="">é€‰æ‹©åº—é“º...</option>';
            shopSummary.shops.forEach(shopId => {
                // æ’é™¤YUPï¼Œå› ä¸ºYUPåªåœ¨é‡‘èåˆ†ætabä¸­æ˜¾ç¤º
                if (shopId === 'YUP') return;
                const option = document.createElement('option');
                option.value = shopId;
                const stats = shopSummary.shop_stats[shopId];
                option.textContent = `åº—é“º ${shopId} (${stats.total_users}ç”¨æˆ·)`;
                shopSelector.appendChild(option);
            });
            
            // ç›‘å¬é€‰æ‹©å˜åŒ–
            shopSelector.addEventListener('change', function(e) {
                const selectedShop = e.target.value;
                if (selectedShop) {
                    switchShop(selectedShop);
                } else {
                    // å¦‚æœé€‰æ‹©"é€‰æ‹©åº—é“º..."ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®
                    loadDefaultShopData();
                }
            });
        }
        
        // åˆ‡æ¢åº—é“º
        function switchShop(shopId) {
            if (!shopData || !shopData[shopId]) {
                console.error(`åº—é“º ${shopId} çš„æ•°æ®ä¸å­˜åœ¨`);
                return;
            }
            
            currentShopId = shopId;
            
            // æ›´æ–°å…¨å±€æ•°æ®å˜é‡
            window.businessInsights = shopData[shopId].businessInsights || [];
            window.userPortraits = shopData[shopId].userPortraits || [];
            window.stats = shopData[shopId].stats || {};
            window.timeSeries = shopData[shopId].timeSeries || [];
            window.userTrajectories = shopData[shopId].userTrajectories || [];
            
            // æ›´æ–°åº—é“ºæŒ‡ç¤ºå™¨
            updateShopIndicator(shopId);
            
            // æ›´æ–°é¡µé¢é¡¶éƒ¨çš„ç»Ÿè®¡æ•°æ®
            if (typeof stats !== 'undefined' && stats) {
                const totalUsersEl = document.getElementById('totalUsers');
                const totalSegmentsEl = document.getElementById('totalSegments');
                const totalClustersEl = document.getElementById('totalClusters');
                
                if (totalUsersEl && typeof animateValue === 'function') {
                    animateValue(totalUsersEl, parseInt(totalUsersEl.textContent) || 0, stats.totalUsers || 0, 1500);
                } else if (totalUsersEl) {
                    totalUsersEl.textContent = stats.totalUsers || 0;
                }
                
                if (totalSegmentsEl && typeof animateValue === 'function') {
                    animateValue(totalSegmentsEl, parseInt(totalSegmentsEl.textContent) || 0, stats.totalSegments || 0, 1500);
                } else if (totalSegmentsEl) {
                    totalSegmentsEl.textContent = stats.totalSegments || 0;
                }
                
                if (totalClustersEl && typeof animateValue === 'function') {
                    animateValue(totalClustersEl, parseInt(totalClustersEl.textContent) || 0, stats.totalClusters || 0, 1500);
                } else if (totalClustersEl) {
                    totalClustersEl.textContent = stats.totalClusters || 0;
                }
            }
            
            // é‡æ–°åŠ è½½å½“å‰æ ‡ç­¾é¡µå†…å®¹
            const activeTab = document.querySelector('.tab-content.active');
            if (activeTab) {
                const tabName = activeTab.id;
                if (typeof loadTabContent === 'function') {
                    loadTabContent(tabName);
                }
            }
        }
        
        // åŠ è½½é»˜è®¤åº—é“ºæ•°æ®
        function loadDefaultShopData() {
            // å¦‚æœå­˜åœ¨é»˜è®¤çš„data.jsæ•°æ®ï¼Œä½¿ç”¨å®ƒ
            if (typeof businessInsights !== 'undefined') {
                currentShopId = null;
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && typeof loadTabContent === 'function') {
                    loadTabContent(activeTab.id);
                }
            }
        }
        
        // æ›´æ–°åº—é“ºæŒ‡ç¤ºå™¨
        function updateShopIndicator(shopId) {
            const shopStats = shopSummary.shop_stats[shopId];
            if (shopStats) {
                const shopSelector = document.getElementById('shopSelector');
                if (shopSelector) {
                    shopSelector.title = `åº—é“º ${shopId} - ${shopStats.total_users} ç”¨æˆ·, ${shopStats.total_segments} ç‰‡æ®µ, ${shopStats.total_clusters} èšç±»`;
                }
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿æ•°æ®å·²åŠ è½½
            setTimeout(function() {
                initShopSelector();
                
            // å¦‚æœæœ‰å¤šåº—é“ºæ•°æ®ä¸”æ²¡æœ‰é€‰æ‹©åº—é“ºï¼Œè‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªåº—é“ºï¼ˆæ’é™¤YUPï¼‰
                if (typeof shopSummary !== 'undefined' && typeof shopData !== 'undefined' && shopSummary.shops.length > 0) {
                const shopsWithoutYUP = shopSummary.shops.filter(s => s !== 'YUP');
                if (shopsWithoutYUP.length > 0 && !currentShopId) {
                    const firstShop = shopsWithoutYUP[0];
                        switchShop(firstShop);
                    }
                }
            }, 1000);
        });
    </script>
</body>
</html>

